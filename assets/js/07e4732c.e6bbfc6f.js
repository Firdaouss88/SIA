"use strict";(self.webpackChunksia_doc=self.webpackChunksia_doc||[]).push([[7559],{3905:function(e,t,r){r.d(t,{Zo:function(){return p},kt:function(){return d}});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=n.createContext({}),u=function(e){var t=n.useContext(i),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},p=function(e){var t=u(e.components);return n.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=u(r),d=a,f=m["".concat(i,".").concat(d)]||m[d]||c[d]||o;return r?n.createElement(f,l(l({ref:t},p),{},{components:r})):n.createElement(f,l({ref:t},p))}));function d(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,l=new Array(o);l[0]=m;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:a,l[1]=s;for(var u=2;u<o;u++)l[u]=r[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},28809:function(e,t,r){r.r(t),r.d(t,{assets:function(){return p},contentTitle:function(){return i},default:function(){return d},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return c}});var n=r(87462),a=r(63366),o=(r(67294),r(3905)),l=["components"],s={},i=void 0,u={unversionedId:"Formation PBI/801200/PowerQuery_Transformation-avancee_Cr\xe9er-Lookup-ou-jointure-sur-une-autre-table",id:"Formation PBI/801200/PowerQuery_Transformation-avancee_Cr\xe9er-Lookup-ou-jointure-sur-une-autre-table",title:"PowerQuery_Transformation-avancee_Cr\xe9er-Lookup-ou-jointure-sur-une-autre-table",description:"Cr\xe9er un Lookup ou une jointure sur une autre table",source:"@site/docs\\80-Formation PBI\\801200\\801222_PowerQuery_Transformation-avancee_Cr\xe9er-Lookup-ou-jointure-sur-une-autre-table.md",sourceDirName:"80-Formation PBI/801200",slug:"/Formation PBI/801200/PowerQuery_Transformation-avancee_Cr\xe9er-Lookup-ou-jointure-sur-une-autre-table",permalink:"/docs/Formation PBI/801200/PowerQuery_Transformation-avancee_Cr\xe9er-Lookup-ou-jointure-sur-une-autre-table",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/80-Formation PBI/801200/801222_PowerQuery_Transformation-avancee_Cr\xe9er-Lookup-ou-jointure-sur-une-autre-table.md",tags:[],version:"current",sidebarPosition:801222,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"PowerQuery_Transformation-avanc\xe9e",permalink:"/docs/Formation PBI/801200/PowerQuery_Transformation-avanc\xe9e"},next:{title:"Mod\xe9lisation des donn\xe9es",permalink:"/docs/Formation PBI/801200/Mod\xe9lisation des donn\xe9es"}},p={},c=[{value:"Cr\xe9er un Lookup ou une jointure sur une autre table",id:"cr\xe9er-un-lookup-ou-une-jointure-sur-une-autre-table",level:2}],m={toc:c};function d(e){var t=e.components,r=(0,a.Z)(e,l);return(0,o.kt)("wrapper",(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"cr\xe9er-un-lookup-ou-une-jointure-sur-une-autre-table"},"Cr\xe9er un Lookup ou une jointure sur une autre table"),(0,o.kt)("p",null,"L'une des fonctions les plus utilis\xe9e dans Excel est le ",(0,o.kt)("strong",{parentName:"p"},"VLOOKUP"),".  Cette fonction permet d'utiliser un champ dans un onglet d'Excel, de retrouver ce champ dans un autre onglet et de retourner chacune des donn\xe9es d'une colonne diff\xe9rente pour l'ajouter au premier onglet."),(0,o.kt)("p",null,"Avec Power Query, la fonction \xe9quivalente se nomme ",(0,o.kt)("strong",{parentName:"p"},"Merge Query"),".  Il suffi d'avoir deux champs identiques entre deux tables pour pouvoir les lier. Une fois li\xe9s, il est possible d'ajouter une ou des colonnes de la seconde table dans la premi\xe8re."),(0,o.kt)("p",null,"Par exemple, dans la table location, nous avons la colonne ",(0,o.kt)("strong",{parentName:"p"},"Name")," qui correspond \xe0 la colonne ",(0,o.kt)("strong",{parentName:"p"},"City")," de la source Web ",(0,o.kt)("strong",{parentName:"p"},"Californie population par ville"),".  Nous allons utiliser ces deux champs pour lier la table ",(0,o.kt)("strong",{parentName:"p"},"Location")," avec la table ",(0,o.kt)("strong",{parentName:"p"},"California population par ville")," et ajouter la ",(0,o.kt)("strong",{parentName:"p"},"Population")," de la seconde table \xe0 la premi\xe8re."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-38.png",alt:"PowerQuery_transformation-de-base-38"})),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Noter que la fusion de requ\xeates ne consiste pas \xe0 cr\xe9er une relation dans le mod\xe8le."),(0,o.kt)("p",{parentName:"blockquote"},"Elle sert seulement \xe0 faire une jointure temporaire afin de r\xe9cup\xe9rer des donn\xe9es dans une table pour les ajouter \xe0 une autre.")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Dans la section ",(0,o.kt)("strong",{parentName:"li"},"Requ\xeates"),", s\xe9lectionner la requ\xeate dans laquelle vous voulez ajouter des colonnes : ",(0,o.kt)("strong",{parentName:"li"},"Location")),(0,o.kt)("li",{parentName:"ol"},"Dans l'onglet ",(0,o.kt)("strong",{parentName:"li"},"Accueil"),", s\xe9lectionner l'option ",(0,o.kt)("strong",{parentName:"li"},"Fusionner des requ\xeates"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-39.png",alt:"PowerQuery_transformation-de-base-39"})),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Dans la fen\xeatre ",(0,o.kt)("strong",{parentName:"p"},"Fusionner"),", s\xe9lectionner la colonne utilis\xe9e pour faire la relation avec la premi\xe8re table : ",(0,o.kt)("strong",{parentName:"p"},"Name")),(0,o.kt)("p",{parentName:"li"},"Cette colonne peut avoir un nom diff\xe9rent dans les deux tables, mais son contenu doit correspondre et avoir le ",(0,o.kt)("strong",{parentName:"p"},"m\xeame format"),".  Si le format est diff\xe9rent, la correspondance sera de 0 %.\nNoter que la correspondance ne doit pas \xeatre de 100 % n\xe9cessairement. Dans un cas inf\xe9rieur \xe0 100 %, aucune donn\xe9e ne sera retourn\xe9e pour les lignes sans correspondance dans la seconde table.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"S\xe9lectionner le nom de la table avec laquelle faire la relation (jointure) : "),(0,o.kt)("p",{parentName:"li"},"Cliquer sur la fl\xe8che pour faire apparaitre le menu d\xe9roulant et s\xe9lectionner la table ",(0,o.kt)("strong",{parentName:"p"},"California population par ville"),"."))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-40.png",alt:"PowerQuery_transformation-de-base-40"})),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"Une fois la table choisie, s\xe9lectionner la colonne utilis\xe9e pour faire la relation de la seconde table : ",(0,o.kt)("strong",{parentName:"li"},"City"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-41.png",alt:"PowerQuery_transformation-de-base-41"})),(0,o.kt)("ol",{start:6},(0,o.kt)("li",{parentName:"ol"},"Parce que la source de donn\xe9es est Web, une fen\xeatre apparaitra.\nS\xe9lectionner ",(0,o.kt)("strong",{parentName:"li"},"Ignorer les contr\xf4les des niveaux de confidentialit\xe9 pour ce fichier...")," puis cliquer ",(0,o.kt)("strong",{parentName:"li"},"Enregistrer"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-42.png",alt:"PowerQuery_transformation-de-base-42"})),(0,o.kt)("ol",{start:7},(0,o.kt)("li",{parentName:"ol"},"Le type de jointure est tr\xe8s important. C'est lui qui d\xe9termine comment la relation est \xe9valu\xe9e et quelles donn\xe9es sont retourn\xe9es suite \xe0 la jointure entre les deux tables.\nS\xe9lectionner ",(0,o.kt)("strong",{parentName:"li"},"Externe gauche")," : Cela retourne 100 % des donn\xe9es de la premi\xe8re table et 100 % des donn\xe9es de la seconde pour les lignes avec une correspondance.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-43.png",alt:"PowerQuery_transformation-de-base-43"})),(0,o.kt)("ol",{start:8},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Un fois la relation ex\xe9cut\xe9e, un message s'affiche dans le bas de la fen\xeatre indiquant combien de lignes ont une correspondance dans la seconde table. Appuyer sur ",(0,o.kt)("strong",{parentName:"p"},"OK")),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-44.png",alt:"PowerQuery_transformation-de-base-44"})))),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"La fusion de requ\xeates ajoute une \xe9tape dans la section ",(0,o.kt)("strong",{parentName:"p"},"\xc9tapes appliqu\xe9es")),(0,o.kt)("p",{parentName:"li"},"Une nouvelle colonne est ajout\xe9e dans la table source et son contenu affiche ",(0,o.kt)("strong",{parentName:"p"},"Table"),"."))),(0,o.kt)("ol",{start:10},(0,o.kt)("li",{parentName:"ol"},"Cela signifie que l'ensemble des donn\xe9es de la seconde table peuvent maintenant \xeatre s\xe9lectionn\xe9es pour \xeatre ajout\xe9es \xe0 la premi\xe8re.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-45.png",alt:"PowerQuery_transformation-de-base-45"})),(0,o.kt)("ol",{start:11},(0,o.kt)("li",{parentName:"ol"},"Cliquer sur l'icone ",(0,o.kt)("strong",{parentName:"li"},"\xc9tendre ou Expand")," ouvre un menu affichant la liste des champs de la table fusionn\xe9e"),(0,o.kt)("li",{parentName:"ol"},"La majorit\xe9 du temps, obtenir l'ensemble des champs n'est pas n\xe9cessaire. Il est possible de s\xe9lectionner ou d\xe9s\xe9lectionner les champs selon le besoin. Pour notre exemple, conserver seulement le champ : ",(0,o.kt)("strong",{parentName:"li"},"Population"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-46.png",alt:"PowerQuery_transformation-de-base-46"})),(0,o.kt)("ol",{start:13},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Ce nouveau champ est au format texte et contient des ",(0,o.kt)("strong",{parentName:"p"},",")," entre les centaines et les milliers."),(0,o.kt)("p",{parentName:"li"},"Faire un clique droit sur la nouvelle colonne ",(0,o.kt)("strong",{parentName:"p"},"Californie population par ville.Population")," pour afficher le menu d\xe9roulant des options de colonne."),(0,o.kt)("p",{parentName:"li"},"S\xe9lectionner l'option ",(0,o.kt)("strong",{parentName:"p"},"Remplacer les valeurs...")))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-47.png",alt:"PowerQuery_transformation-de-base-47"})),(0,o.kt)("ol",{start:14},(0,o.kt)("li",{parentName:"ol"},"Dans la fen\xeatre ",(0,o.kt)("strong",{parentName:"li"},"Remplacer les valeurs"),", saisir  ",(0,o.kt)("strong",{parentName:"li"},",")," dans la case ",(0,o.kt)("strong",{parentName:"li"},"Valeur \xe0 rechercher")," et laisser la case ",(0,o.kt)("strong",{parentName:"li"},"Remplacer par")," vide.\nCliquer sur ",(0,o.kt)("strong",{parentName:"li"},"OK"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-48.png",alt:"PowerQuery_transformation-de-base-48"})),(0,o.kt)("ol",{start:15},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Cliquer sur l'icone de format des donn\xe9es \xe0 gauche de la colonne  ",(0,o.kt)("strong",{parentName:"p"},"Californie population par ville.Population"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"S\xe9lectionner ",(0,o.kt)("strong",{parentName:"p"},"Nombre entier")),(0,o.kt)("p",{parentName:"li"},"Si on ne fait pas le remplacement des valeurs, la conversion ne se faire pas correctement et on un r\xe9sultat erron\xe9."))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"C:/DEV/Source/Repos/IQ-PROJET-SIA-DOC2/SIA-DOC/static/img/801200/PowerQuery_transformation-de-base-49.png",alt:"PowerQuery_transformation-de-base-49"})))}d.isMDXComponent=!0}}]);